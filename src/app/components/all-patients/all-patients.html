<div *ngIf="!isLoggedIn" class="flex justify-center items-center h-screen">
  <p class="text-center text-xl text-blue-600">You need to be logged in to access patient records. Redirecting to login...</p>
</div>

<!-- If logged in, display patient records -->
<div *ngIf="isLoggedIn">
  <div class="flex justify-center mb-4">
    <input 
      type="text" 
      [(ngModel)]="searchQuery" 
      (ngModelChange)="onSearch()" 
      placeholder="Search by name" 
      class="p-2 w-96 border-2 border-green-500 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
  </div>

  <!-- No results message -->
  <div *ngIf="isSearching && filteredPatients.length === 0" class="text-center text-lg text-gray-500">
    <p>No patients found for the search query.</p>
  </div>

  <div *ngIf="!isSearching && filteredPatients.length === 0" class="text-center text-lg text-gray-500">
    <p>No patients available.</p>
  </div>

  <!-- Display the patient records in a table -->
  <table *ngIf="filteredPatients.length > 0" class="min-w-full bg-white border-collapse shadow-lg rounded-lg overflow-hidden">
    <thead class="bg-blue-600 text-white">
      <tr>
        <th class="p-4 text-left">First Name</th>
        <th class="p-4 text-left">Last Name</th>
        <th class="p-4 text-left">Phone Number</th>
        <th class="p-4 text-left">Email</th>
        <th class="p-4 text-left">Action</th> <!-- Added Action column for "Show Details" -->
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let patient of filteredPatients" class="hover:bg-gray-100 cursor-pointer">
        <td class="p-4">{{ patient.first_name }}</td>
        <td class="p-4">{{ patient.last_name }}</td>
        <td class="p-4">{{ patient.phone_number }}</td>
        <td class="p-4">{{ patient.email }}</td>
        <td class="p-4">
          <button (click)="onPatientClick(patient)" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
            Show Details
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Patient Details Modal -->
<div *ngIf="selectedPatient" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center">
  <div class="bg-white p-6 rounded-lg shadow-xl max-w-md w-full">
    <h3 class="text-2xl font-bold mb-4">Patient Details</h3>
    <p><strong>First Name:</strong> {{ selectedPatient.first_name }}</p>
    <p><strong>Last Name:</strong> {{ selectedPatient.last_name }}</p>
    <p><strong>Email:</strong> {{ selectedPatient.email }}</p>
    <p><strong>Phone Number:</strong> {{ selectedPatient.phone_number }}</p>
    <p><strong>Address:</strong> {{ selectedPatient.residential_address }}</p>
    <p><strong>Emergency Contact:</strong> {{ selectedPatient.emergency_name }} - {{ selectedPatient.emergency_phone }}</p>
    <p><strong>Ghana Card Number:</strong> {{ selectedPatient.ghana_card_number }}</p> <!-- Added Ghana Card Number -->
    <button (click)="closeModal()" class="mt-4 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 w-full">Close</button>
  </div>
</div>
